<?xml version="1.0" ?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->


<Root>
    <TestCase name="testAllCases">
        <Resource name="query00.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$5], COL6=[*(3, $4)], COL7=[$6], COL8=[$7], COL9=[$1], COL91=[CASE(OR(=($8, 0), AND(<>($4, 0), =($8, 0))), 0:DECIMAL(38, 4), *($4, $8))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL1=[COUNT()], COL2=[SUM($2)], COL4=[SUM($3)], COL5=[COUNT($3)], COL7=[SUM($4)], COL8=[SUM($5)], agg#6=[SUM($6)], ctx=[])
      OlapProjectRel(COL3=[$6], COL9=[$11], $f2=[CASE(<=($11, 2012-12-31), *($7, 4), >($11, 2012-12-31), 1:DECIMAL(30, 4), null:DECIMAL(30, 4))], PRICE=[$7], $f4=[*($7, 3)], $f5=[/($7, 2)], ITEM_COUNT=[$8], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query00.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$5], COL6=[*(3, $4)], COL7=[$6], COL8=[$7], COL9=[$1], COL91=[CASE(OR(=($8, 0), AND(<>($4, 0), =($8, 0))), 0:DECIMAL(38, 4), *($4, $8))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[$SUM0($2)], AGG$1=[SUM($3)], AGG$2=[SUM($4)], AGG$3=[$SUM0($5)], AGG$4=[SUM($6)], AGG$5=[SUM($7)], AGG$6=[SUM($8)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], COL1=[$3], $f3=[CASE(<=($2, 2012-12-31), $9, >($2, 2012-12-31), $10, null:DECIMAL(30, 4))], COL4=[$4], COL5=[$5], COL7=[$6], COL8=[$7], $f8=[$8], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[$SUM0($3)], AGG$1=[SUM($4)], AGG$2=[$SUM0($5)], AGG$3=[SUM($6)], AGG$4=[SUM($7)], AGG$5=[SUM($8)], AGG$6=[SUM($9)], AGG$7=[SUM($10)], AGG$8=[SUM($11)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], COL4=[$4], COL5=[$5], $f6=[CAST(*($6, 3)):DECIMAL(38, 4)], $f7=[CAST(/($7, 2)):DECIMAL(38, 15)], $f8=[$8], $f9=[CAST(*($9, 4)):DECIMAL(38, 4)], SUM_CASE$0$1=[$10], SUM_CASE$0$2=[$11], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[$SUM0($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[$SUM0($5)], TOP_AGG$3=[SUM($6)], TOP_AGG$4=[SUM($7)], TOP_AGG$5=[SUM($8)], TOP_AGG$6=[SUM($9)], TOP_AGG$7=[SUM($10)], TOP_AGG$8=[SUM($11)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], COL4=[$4], COL5=[$5], SUM_OP$0=[$6], SUM_OP$1=[$7], $f8=[$8], SUM_OP$2=[$9], COL10=[CAST($3):DECIMAL(38, 4) NOT NULL], $f11=[*(0, $3)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COL1=[COUNT()], COL4=[SUM($3)], COL5=[COUNT($4)], SUM_OP$0=[SUM($5)], SUM_OP$1=[SUM($6)], agg#5=[SUM($7)], SUM_OP$2=[SUM($8)], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$11], CAL_DT00=[$11], PRICE=[$7], PRICE0=[$7], PRICE1=[$7], PRICE2=[$7], ITEM_COUNT=[$8], PRICE3=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query00-if.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$5], COL6=[*(3, $4)], COL7=[$6], COL8=[$7], COL9=[$1], COL91=[CASE(OR(=($8, 0), AND(<>($4, 0), =($8, 0))), 0:DECIMAL(38, 4), *($4, $8))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL1=[COUNT()], COL2=[SUM($2)], COL4=[SUM($3)], COL5=[COUNT($3)], COL7=[SUM($4)], COL8=[SUM($5)], agg#6=[SUM($6)], ctx=[])
      OlapProjectRel(COL3=[$6], COL9=[$11], $f2=[IF(<=($11, 2012-12-31), *($7, 4), 1)], PRICE=[$7], $f4=[*($7, 3)], $f5=[/($7, 2)], ITEM_COUNT=[$8], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query00-if.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$5], COL6=[*(3, $4)], COL7=[$6], COL8=[$7], COL9=[$1], COL91=[CASE(OR(=($8, 0), AND(<>($4, 0), =($8, 0))), 0:DECIMAL(38, 4), *($4, $8))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[$SUM0($2)], AGG$1=[SUM($3)], AGG$2=[SUM($4)], AGG$3=[$SUM0($5)], AGG$4=[SUM($6)], AGG$5=[SUM($7)], AGG$6=[SUM($8)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], COL1=[$3], $f3=[CASE(<=($2, 2012-12-31), $9, $10)], COL4=[$4], COL5=[$5], COL7=[$6], COL8=[$7], $f8=[$8], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[$SUM0($3)], AGG$1=[SUM($4)], AGG$2=[$SUM0($5)], AGG$3=[SUM($6)], AGG$4=[SUM($7)], AGG$5=[SUM($8)], AGG$6=[SUM($9)], AGG$7=[SUM($10)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], COL4=[$4], COL5=[$5], $f6=[CAST(*($6, 3)):DECIMAL(38, 4)], $f7=[CAST(/($7, 2)):DECIMAL(38, 15)], $f8=[$8], $f9=[CAST(*($9, 4)):DECIMAL(38, 4)], SUM_CASE$0$1=[$10], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[$SUM0($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[$SUM0($5)], TOP_AGG$3=[SUM($6)], TOP_AGG$4=[SUM($7)], TOP_AGG$5=[SUM($8)], TOP_AGG$6=[SUM($9)], TOP_AGG$7=[SUM($10)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], COL4=[$4], COL5=[$5], SUM_OP$0=[$6], SUM_OP$1=[$7], $f8=[$8], SUM_OP$2=[$9], COL10=[$3], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COL1=[COUNT()], COL4=[SUM($3)], COL5=[COUNT($4)], SUM_OP$0=[SUM($5)], SUM_OP$1=[SUM($6)], agg#5=[SUM($7)], SUM_OP$2=[SUM($8)], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$11], CAL_DT00=[$11], PRICE=[$7], PRICE0=[$7], PRICE1=[$7], PRICE2=[$7], ITEM_COUNT=[$8], PRICE3=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>

        </Resource>
        <Resource name="query01.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[0]], groups=[null], COL92=[SUM($1)], COL3=[SUM($2)], ctx=[])
    OlapProjectRel(COL1=[$10], $f1=[CASE(=($2, 'ABIN'), 0, 1)], $f2=[CASE(AND(=(EXTRACT(FLAG(YEAR), $10), 2012), =(EXTRACT(FLAG(MONTH), $10), 3), <=($10, 2012-03-13)), *($7, 2), OR(<>(EXTRACT(FLAG(YEAR), $10), 2012), <>(EXTRACT(FLAG(MONTH), $10), 3), >($10, 2012-03-13)), 1:DECIMAL(30, 4), null:DECIMAL(30, 4))], ctx=[])
      OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
        OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
          OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
          OlapProjectRel(COUNTRY=[$0], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
        OlapProjectRel(COUNTRY=[$0], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query01.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], AGG$1=[SUM($2)], ctx=[])
    OlapProjectRel(CAL_DT0=[$0], $f1=[CASE(=($1, 'ABIN'), $3, $4)], $f2=[CASE(AND(=(EXTRACT(FLAG(YEAR), $2), 2012), =(EXTRACT(FLAG(MONTH), $2), 3), <=($2, 2012-03-13)), $5, OR(<>(EXTRACT(FLAG(YEAR), $2), 2012), <>(EXTRACT(FLAG(MONTH), $2), 3), >($2, 2012-03-13)), $6, null:DECIMAL(30, 4))], ctx=[])
      OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[SUM($3)], AGG$1=[SUM($4)], AGG$2=[SUM($5)], AGG$3=[SUM($6)], AGG$4=[SUM($7)], ctx=[])
        OlapProjectRel(CAL_DT0=[$0], LSTG_FORMAT_NAME=[$1], CAL_DT00=[$2], SUM_CASE$0$0=[$3], SUM_CASE$0$1=[$4], $f5=[CAST(*($5, 2)):DECIMAL(38, 4)], SUM_CASE$1$1=[$6], SUM_CASE$1$2=[$7], ctx=[])
          OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[SUM($5)], TOP_AGG$3=[SUM($6)], TOP_AGG$4=[SUM($7)], ctx=[])
            OlapProjectRel(CAL_DT0=[$0], LSTG_FORMAT_NAME=[$1], CAL_DT00=[$2], $f3=[*(0, $3)], SUM_CONST$0=[$3], SUM_OP$0=[$4], SUM_CONST$00=[CAST($3):DECIMAL(38, 4) NOT NULL], $f7=[*(0, $3)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_CONST$0=[COUNT()], SUM_OP$0=[SUM($3)], ctx=[])
                OlapProjectRel(CAL_DT0=[$10], LSTG_FORMAT_NAME=[$2], CAL_DT00=[$10], PRICE=[$7], ctx=[])
                  OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                    OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                    OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                  OlapProjectRel(CAL_DT=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                  OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                              OlapProjectRel(SITE_ID=[$0], ctx=[])
                                OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                            OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                              OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                          OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                        OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                      OlapProjectRel(COUNTRY=[$0], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                    OlapProjectRel(COUNTRY=[$0], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query02.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[CASE(<=($0, 2012-12-31), $1, >($0, 2012-12-31), 1:DECIMAL(29, 4), null:DECIMAL(29, 4))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], ctx=[])
      OlapProjectRel(CAL_DT0=[$2], PRICE_SUM=[$1], COL1=[$3], ctx=[])
        OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], PRICE_SUM=[SUM($1)], ctx=[])
            OlapProjectRel(CAL_DT=[$2], $f1=[CASE(=($3, 'FP-non GTC'), $8, 2:DECIMAL(19, 4))], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(CAL_DT=[$0], WEEK_BEG_DT=[$4], ctx=[])
            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
]]>
        </Resource>
        <Resource name="query02.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[CASE(<=($0, 2012-12-31), $1, >($0, 2012-12-31), 1:DECIMAL(29, 4), null:DECIMAL(29, 4))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], ctx=[])
      OlapProjectRel(CAL_DT0=[$2], PRICE_SUM=[$1], COL1=[$3], ctx=[])
        OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
            OlapProjectRel(CAL_DT=[$0], $f1=[CASE(=($1, 'FP-non GTC'), $2, $3)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], ctx=[])
                OlapProjectRel(CAL_DT=[$0], LSTG_FORMAT_NAME=[$1], SUM_CASE$0$0=[$2], $f3=[CAST(*(2:DECIMAL(19, 4), $3)):DECIMAL(29, 4) NOT NULL], ctx=[])
                  OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_CASE$0$0=[SUM($2)], SUM_CONST$1=[COUNT()], ctx=[])
                    OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(CAL_DT=[$0], WEEK_BEG_DT=[$4], ctx=[])
            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
]]>
        </Resource>
        <Resource name="query03.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$1], COL6=[$5], COL7=[*(2, $4)], COL8=[$6], COL9=[ROUND($7, 6)], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL1=[COUNT()], COL2=[SUM($2)], COL4=[SUM($3)], COL6=[COUNT($3)], COL8=[SUM($4)], agg#5=[SUM($5)], ctx=[])
      OlapProjectRel(COL3=[$6], COL5=[$11], $f2=[*($7, 4)], PRICE=[$7], $f4=[*($8, 3)], $f5=[/($8, 3.0:DECIMAL(2, 1))], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query03.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$4], COL5=[$1], COL6=[$5], COL7=[*(2, $4)], COL8=[$6], COL9=[ROUND($7, 6)], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[$SUM0($2)], AGG$1=[SUM($3)], AGG$2=[SUM($4)], AGG$3=[$SUM0($5)], AGG$4=[SUM($6)], AGG$5=[SUM($7)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], COL1=[$2], $f3=[CAST(*($3, 4)):DECIMAL(38, 4)], COL4=[$4], COL6=[$5], $f6=[CAST(*($6, 3)):BIGINT], $f7=[CAST(/($7, 3.0:DECIMAL(2, 1))):DECIMAL(27, 6)], ctx=[])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL1=[COUNT()], SUM_OP$0=[SUM($2)], COL4=[SUM($3)], COL6=[COUNT($4)], SUM_OP$1=[SUM($5)], SUM_OP$2=[SUM($6)], ctx=[])
          OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$11], PRICE=[$7], PRICE0=[$7], PRICE1=[$7], ITEM_COUNT=[$8], ITEM_COUNT0=[$8], ctx=[])
            OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
              OlapJoinRel(condition=[=($19, $21)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($17, $20)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($10, $18)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($6, $16)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($5, $15)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($4, $14)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[AND(=($3, $12), =($4, $13))], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($1, $11)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($0, $9)], joinType=[inner], ctx=[])
                                OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
                                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                  OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                              OlapProjectRel(CAL_DT=[$0], ctx=[])
                                OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                            OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                          OlapProjectRel(SITE_ID=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                        OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                          OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                      OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                    OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                  OlapProjectRel(COUNTRY=[$0], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                OlapProjectRel(COUNTRY=[$0], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query04.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[CASE(<=($0, 2012-12-31), $1, >($0, 2012-12-31), 1:DECIMAL(38, 4), null:DECIMAL(38, 4))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], ctx=[])
      OlapProjectRel(CAL_DT0=[$2], PRICE_SUM=[$1], COL1=[$3], ctx=[])
        OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], PRICE_SUM=[SUM($1)], ctx=[])
            OlapProjectRel(CAL_DT=[$2], $f1=[CASE(=($3, 'FP-non GTC'), *($8, 2), 2:DECIMAL(30, 4))], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(CAL_DT=[$0], WEEK_BEG_DT=[$4], ctx=[])
            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
]]>
        </Resource>
        <Resource name="query04.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[CASE(<=($0, 2012-12-31), $1, >($0, 2012-12-31), 1:DECIMAL(38, 4), null:DECIMAL(38, 4))], ctx=[])
    OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], ctx=[])
      OlapProjectRel(CAL_DT0=[$2], PRICE_SUM=[$1], COL1=[$3], ctx=[])
        OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
            OlapProjectRel(CAL_DT=[$0], $f1=[CASE(=($1, 'FP-non GTC'), $2, $3)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], AGG$1=[SUM($3)], ctx=[])
                OlapProjectRel(CAL_DT=[$0], LSTG_FORMAT_NAME=[$1], $f2=[CAST(*($2, 2)):DECIMAL(38, 4)], SUM_CASE$0$1=[$3], ctx=[])
                  OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], ctx=[])
                    OlapProjectRel(CAL_DT=[$0], LSTG_FORMAT_NAME=[$1], SUM_OP$0=[$2], $f3=[*(2:DECIMAL(30, 4), $3)], ctx=[])
                      OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_OP$0=[SUM($2)], SUM_CONST$1=[COUNT()], ctx=[])
                        OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(CAL_DT=[$0], WEEK_BEG_DT=[$4], ctx=[])
            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
]]>
        </Resource>
        <Resource name="query05.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], TWO_COL_PLUS_SUM=[SUM($0)], TWO_COL_PLUS_CONST_SUM=[SUM($1)], CONST_MINUS_COL_SUM=[SUM($2)], CONST_MINUS_COL_PLUS_COL_SUM=[SUM($3)], ctx=[])
    OlapProjectRel($f0=[+($1, $2)], $f1=[+(+($1, $2), 100)], $f2=[-(-(1000000, $1), $2)], $f3=[+(-(1000000.0:DECIMAL(8, 1), $1), $2)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], A2=[SUM($2)], ctx=[])
        OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], TWO_COL_PLUS_SUM=[SUM($0)], TWO_COL_PLUS_CONST_SUM=[SUM($1)], CONST_MINUS_COL_SUM=[SUM($2)], CONST_MINUS_COL_PLUS_COL_SUM=[SUM($3)], ctx=[])
    OlapProjectRel($f0=[+($1, $2)], $f1=[+(+($1, $2), 100)], $f2=[-(-(1000000, $1), $2)], $f3=[+(-(1000000.0:DECIMAL(8, 1), $1), $2)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], A2=[SUM($2)], ctx=[])
        OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query06.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], SUM_EXPR=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$3], $f1=[CASE(AND(=($1, 1050), =($2, 2012-10-29)), $8, null:DECIMAL(19, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query06.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$0], $f1=[CASE(AND(=($1, 1050), =($2, 2012-10-29)), $3, null:DECIMAL(19, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], ORDER_ID=[$1], CAL_DT=[$2], SUM_CASE$0$0=[$3], $f4=[*(0, $4)], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_CASE$0$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], ORDER_ID=[$1], CAL_DT=[$2], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query07.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], SUM_EXPR=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$3], $f1=[CASE(AND(=($3, 'ABIN'), =($2, 2013-11-20)), $8, null:DECIMAL(19, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query07.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$0], $f1=[CASE(AND(=($2, 'ABIN'), =($1, 2013-11-20)), $3, null:DECIMAL(19, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], CAL_DT=[$1], LSTG_FORMAT_NAME0=[$2], SUM_CASE$0$0=[$3], $f4=[*(0, $4)], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_CASE$0$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], CAL_DT=[$2], LSTG_FORMAT_NAME0=[$3], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query10.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapUnionRel(all=[true], ctx=[], all=[true])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[*($1, 2)], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], ctx=[])
          OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[*($1, 2)], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], ctx=[])
          OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query10.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapUnionRel(all=[true], ctx=[], all=[true])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[*($1, 2)], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], ctx=[])
          OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[*($1, 2)], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], A1=[SUM($1)], ctx=[])
          OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query11.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapUnionRel(all=[true], ctx=[], all=[true])
    OlapProjectRel(EXPR=[$0], PRI=[CAST(/($1, $2)):BIGINT], PPP=[CAST(/(-($3, /(*($4, $4), $5)), $5)):BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], agg#3=[SUM($3)], agg#4=[SUM($2)], agg#5=[COUNT($2)], ctx=[])
        OlapProjectRel($f0=[*($0, 2)], $f1=[*(/($1, $2), 2)], PRI=[/($1, $2)], $f3=[*(/($1, $2), /($1, $2))], ctx=[])
          OlapAggregateRel(group-set=[[]], groups=[null], A1=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], ctx=[])
            OlapProjectRel(PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    OlapProjectRel(EXPR=[$0], PRI=[CAST(/($1, $2)):BIGINT], PPP=[CAST(/(-($3, /(*($4, $4), $5)), $5)):BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], agg#3=[SUM($3)], agg#4=[SUM($2)], agg#5=[COUNT($2)], ctx=[])
        OlapProjectRel($f0=[*($0, 2)], $f1=[*(/($1, $2), 2)], PRI=[/($1, $2)], $f3=[*(/($1, $2), /($1, $2))], ctx=[])
          OlapAggregateRel(group-set=[[]], groups=[null], A1=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], ctx=[])
            OlapProjectRel(PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query11.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapUnionRel(all=[true], ctx=[], all=[true])
    OlapProjectRel(EXPR=[$0], PRI=[CAST(/($1, $2)):BIGINT], PPP=[CAST(/(-($3, /(*($4, $4), $5)), $5)):BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], agg#3=[SUM($3)], agg#4=[SUM($2)], agg#5=[COUNT($2)], ctx=[])
        OlapProjectRel($f0=[*($0, 2)], $f1=[*(/($1, $2), 2)], PRI=[/($1, $2)], $f3=[*(/($1, $2), /($1, $2))], ctx=[])
          OlapAggregateRel(group-set=[[]], groups=[null], A1=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], ctx=[])
            OlapProjectRel(PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    OlapProjectRel(EXPR=[$0], PRI=[CAST(/($1, $2)):BIGINT], PPP=[CAST(/(-($3, /(*($4, $4), $5)), $5)):BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], EXPR=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], agg#3=[SUM($3)], agg#4=[SUM($2)], agg#5=[COUNT($2)], ctx=[])
        OlapProjectRel($f0=[*($0, 2)], $f1=[*(/($1, $2), 2)], PRI=[/($1, $2)], $f3=[*(/($1, $2), /($1, $2))], ctx=[])
          OlapAggregateRel(group-set=[[]], groups=[null], A1=[SUM($0)], agg#1=[SUM($1)], agg#2=[COUNT($1)], ctx=[])
            OlapProjectRel(PRICE=[$8], ITEM_COUNT=[$9], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query12.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], C1=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[*(CASE(LIKE($3, 'A%'), $8, null:DECIMAL(19, 4)), 2)], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query12.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], C1=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[*(CASE(LIKE($3, 'A%'), $8, null:DECIMAL(19, 4)), 2)], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query13.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(C1=[$0], C2=[$0], C3=[$1], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], agg#0=[SUM($0)], agg#1=[SUM($1)], ctx=[])
      OlapProjectRel($f0=[CASE(>($5, 2), *(CEIL($8), 2), null:DECIMAL(30, 0))], $f1=[CASE(>($5, 2), *(FLOOR($8), 2), null:DECIMAL(30, 0))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query13.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(C1=[$0], C2=[$0], C3=[$1], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], AGG$1=[SUM($1)], ctx=[])
      OlapProjectRel($f0=[CASE(>($0, 2), $2, null:DECIMAL(30, 0))], $f1=[CASE(>($1, 2), $4, null:DECIMAL(30, 0))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], TOP_AGG$2=[SUM($4)], TOP_AGG$3=[SUM($5)], ctx=[])
          OlapProjectRel(LSTG_SITE_ID=[$0], LSTG_SITE_ID0=[$1], SUM_CASE$0$0=[$2], $f3=[*(0, $3)], SUM_CASE$1$0=[$4], $f5=[*(0, $3)], ctx=[])
            OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_CASE$0$0=[SUM($2)], SUM_CONST$1=[COUNT()], SUM_CASE$1$0=[SUM($3)], ctx=[])
              OlapProjectRel(LSTG_SITE_ID=[$5], LSTG_SITE_ID0=[$5], $f2=[*(CEIL($8), 2)], $f3=[*(FLOOR($8), 2)], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query14.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], C1=[SUM($0)], C2=[SUM($1)], C3=[SUM($2)], ctx=[])
    OlapProjectRel($f0=[*(EXTRACT(FLAG(YEAR), $2), 2)], $f1=[*(EXTRACT(FLAG(MONTH), $2), 2)], $f2=[/(EXTRACT(FLAG(MONTH), $2), 2.0:DECIMAL(2, 1))], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query14.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], C1=[SUM($0)], C2=[SUM($1)], C3=[SUM($2)], ctx=[])
    OlapProjectRel($f0=[*(EXTRACT(FLAG(YEAR), $2), 2)], $f1=[*(EXTRACT(FLAG(MONTH), $2), 2)], $f2=[/(EXTRACT(FLAG(MONTH), $2), 2.0:DECIMAL(2, 1))], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query15.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(C1=[CAST($0):DECIMAL(15, 4)], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], agg#0=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[CASE(>($5, 2), *(*($8, 2), 3), null:DECIMAL(38, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query15.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(C1=[CAST($0):DECIMAL(15, 4)], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[CASE(>($0, 2), $1, null:DECIMAL(38, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], AGG$1=[SUM($2)], ctx=[])
          OlapProjectRel(LSTG_SITE_ID=[$0], $f1=[*(*($1, 2), 3)], SUM_CASE$0$1=[$2], ctx=[])
            OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[SUM($2)], ctx=[])
              OlapProjectRel(LSTG_SITE_ID=[$0], SUM_OP$0=[$1], $f2=[*(0, $2)], ctx=[])
                OlapAggregateRel(group-set=[[0]], groups=[null], SUM_OP$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
                  OlapProjectRel(LSTG_SITE_ID=[$5], PRICE=[$8], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query21.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapSortRel(sort0=[$1], dir0=[ASC-nulls-first], ctx=[])
    OlapProjectRel(MAX_PRICE=[$1], LSTG_FORMAT_NAME=[$0], COL1=[$2], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], MAX_PRICE=[MAX($1)], COL1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], $f2=[CASE(>($4, 10), $8, <($4, 100), 1:DECIMAL(19, 4), null:DECIMAL(19, 4))], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query21.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapSortRel(sort0=[$1], dir0=[ASC-nulls-first], ctx=[])
    OlapProjectRel(MAX_PRICE=[$1], LSTG_FORMAT_NAME=[$0], COL1=[$2], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[MAX($1)], AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$0], MAX_PRICE=[$2], $f2=[CASE(>($1, 10), $3, <($1, 100), $4, null:DECIMAL(19, 4))], ctx=[])
          OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[MAX($2)], TOP_AGG$1=[SUM($3)], TOP_AGG$2=[SUM($4)], TOP_AGG$3=[SUM($5)], ctx=[])
            OlapProjectRel(LSTG_FORMAT_NAME=[$0], LEAF_CATEG_ID=[$1], MAX_PRICE=[$2], SUM_CASE$0$0=[$3], SUM_CONST$2=[CAST(CAST($4):DECIMAL(38, 4) NOT NULL):DECIMAL(29, 4) NOT NULL], $f5=[*(0, $4)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1]], groups=[null], MAX_PRICE=[MAX($2)], SUM_CASE$0$0=[SUM($3)], SUM_CONST$2=[COUNT()], ctx=[])
                OlapProjectRel(LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], PRICE=[$8], PRICE0=[$8], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query22.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapSortRel(sort0=[$1], dir0=[ASC-nulls-first], ctx=[])
    OlapProjectRel(MAX_PRICE=[$1], LSTG_FORMAT_NAME=[$0], COL1=[$2], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], MAX_PRICE=[MIN($1)], COL1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], $f2=[CASE(>($4, 10), $8, <($4, 100), 1:DECIMAL(19, 4), null:DECIMAL(19, 4))], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query22.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapSortRel(sort0=[$1], dir0=[ASC-nulls-first], ctx=[])
    OlapProjectRel(MAX_PRICE=[$1], LSTG_FORMAT_NAME=[$0], COL1=[$2], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[MIN($1)], AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$0], MAX_PRICE=[$2], $f2=[CASE(>($1, 10), $3, <($1, 100), $4, null:DECIMAL(19, 4))], ctx=[])
          OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[MIN($2)], TOP_AGG$1=[SUM($3)], TOP_AGG$2=[SUM($4)], TOP_AGG$3=[SUM($5)], ctx=[])
            OlapProjectRel(LSTG_FORMAT_NAME=[$0], LEAF_CATEG_ID=[$1], MAX_PRICE=[$2], SUM_CASE$0$0=[$3], SUM_CONST$2=[CAST(CAST($4):DECIMAL(38, 4) NOT NULL):DECIMAL(29, 4) NOT NULL], $f5=[*(0, $4)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1]], groups=[null], MAX_PRICE=[MIN($2)], SUM_CASE$0$0=[SUM($3)], SUM_CONST$2=[COUNT()], ctx=[])
                OlapProjectRel(LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], PRICE=[$8], PRICE0=[$8], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query25.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL1=[COUNT()], COL2=[SUM($2)], ctx=[])
      OlapProjectRel(COL3=[CASE(=($6, 0), 0, <=($6, 1), 1, $6)], COL4=[$10], $f2=[CASE(<=($10, 2012-12-31), *($7, 4), >($10, 2012-12-31), 1:DECIMAL(30, 4), 0:DECIMAL(30, 4))], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query25.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$2], COL2=[$3], COL3=[$0], COL4=[$1], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[$SUM0($2)], AGG$1=[SUM($3)], ctx=[])
      OlapProjectRel($f0=[CASE(=($0, 0), 0, <=($0, 1), 1, $0)], CAL_DT0=[$1], COL1=[$3], $f3=[CASE(<=($2, 2012-12-31), $4, >($2, 2012-12-31), $5, $6)], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[$SUM0($3)], AGG$1=[SUM($4)], AGG$2=[SUM($5)], AGG$3=[SUM($6)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], $f4=[CAST(*($4, 4)):DECIMAL(38, 4)], SUM_CASE$0$1=[$5], SUM_CASE$0$2=[$6], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[$SUM0($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[SUM($5)], TOP_AGG$3=[SUM($6)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], COL1=[$3], SUM_OP$0=[$4], COL10=[CAST($3):DECIMAL(38, 4) NOT NULL], $f6=[*(0:DECIMAL(30, 4), $3)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COL1=[COUNT()], SUM_OP$0=[SUM($3)], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], CAL_DT00=[$10], PRICE=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query26.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], $f2=[CASE(<=($10, 2012-12-31), /($7, 100), null:DECIMAL(30, 15))], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query26.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], $f2=[CASE(<=($2, 2012-12-31), $3, null:DECIMAL(30, 15))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[SUM($3)], AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], $f3=[CAST(/($3, 100)):DECIMAL(38, 15)], SUM_CASE$0$1=[$4], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], SUM_OP$0=[$3], $f4=[*(0, $4)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_OP$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], CAL_DT00=[$10], PRICE=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query27.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], $f2=[CASE(<=($10, 2012-12-31), CAST(/($7, 100)):DOUBLE, null:DOUBLE)], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query27.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], $f2=[CASE(<=($2, 2012-12-31), CAST($3):DOUBLE, null:DOUBLE)], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[SUM($3)], AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], $f3=[CAST(/($3, 100)):DECIMAL(38, 15)], SUM_CASE$0$1=[$4], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], SUM_OP$0=[$3], $f4=[*(0, $4)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_OP$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], CAL_DT00=[$10], PRICE=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query28.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], COL=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], $f2=[CASE(<=($10, 2012-12-31), /($7, 100), >($10, 2012-12-31), 1:DECIMAL(30, 15), null:DECIMAL(30, 15))], ctx=[])
        OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
          OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                            OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                            OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(CAL_DT=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                        OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                      OlapProjectRel(SITE_ID=[$0], ctx=[])
                        OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                    OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                  OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(COUNTRY=[$0], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query28.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL=[$2], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], ctx=[])
      OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], $f2=[CASE(<=($2, 2012-12-31), $3, >($2, 2012-12-31), $4, null:DECIMAL(30, 15))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[SUM($3)], AGG$1=[SUM($4)], AGG$2=[SUM($5)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], $f3=[CAST(/($3, 100)):DECIMAL(38, 15)], SUM_CASE$0$1=[$4], SUM_CASE$0$2=[$5], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[SUM($5)], ctx=[])
              OlapProjectRel(SELLER_ID=[$0], CAL_DT0=[$1], CAL_DT00=[$2], SUM_OP$0=[$3], SUM_CONST$1=[CAST(CAST($4):DECIMAL(38, 6) NOT NULL):DECIMAL(38, 15) NOT NULL], $f5=[*(0, $4)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_OP$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
                  OlapProjectRel(SELLER_ID=[$6], CAL_DT0=[$10], CAL_DT00=[$10], PRICE=[$7], ctx=[])
                    OlapFilterRel(condition=[=($2, 'FP-GTC')], ctx=[])
                      OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                      OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                        OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                      OlapProjectRel(CAL_DT=[$0], ctx=[])
                                        OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                    OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                      OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                  OlapProjectRel(SITE_ID=[$0], ctx=[])
                                    OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                                OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(COUNTRY=[$0], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query29.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$1], COL2=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], COL1=[SUM($1)], ctx=[])
      OlapProjectRel(COL2=[-($6, $9)], $f1=[CASE(=($2, 'ABIN'), $7, null:DECIMAL(19, 4))], ctx=[])
        OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
          OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                          OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                          OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                        OlapProjectRel(CAL_DT=[$0], ctx=[])
                          OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                      OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                    OlapProjectRel(SITE_ID=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                  OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                    OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
          OlapProjectRel(COUNTRY=[$0], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query29.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$1], COL2=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
      OlapProjectRel($f0=[-($0, $1)], $f1=[CASE(=($2, 'ABIN'), $3, null:DECIMAL(19, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(SELLER_ID=[$0], BUYER_ID=[$1], LSTG_FORMAT_NAME=[$2], SUM_CASE$0$0=[$3], $f4=[*(0, $4)], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_CASE$0$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
              OlapProjectRel(SELLER_ID=[$6], BUYER_ID=[$9], LSTG_FORMAT_NAME=[$2], PRICE=[$7], ctx=[])
                OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                  OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                    OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                  OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                    OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                OlapProjectRel(CAL_DT=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                              OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                            OlapProjectRel(SITE_ID=[$0], ctx=[])
                              OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                          OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                            OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                        OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                      OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                    OlapProjectRel(COUNTRY=[$0], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                  OlapProjectRel(COUNTRY=[$0], ctx=[])
                    OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query30.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$1], COL2=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], COL1=[SUM($1)], ctx=[])
      OlapProjectRel(COL2=[CASE(=($3, 'ABIN'), $7, null:INTEGER)], $f1=[CASE(=($3, 'ABIN'), $8, null:DECIMAL(19, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query30.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$1], COL2=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
      OlapProjectRel($f0=[CASE(=($0, 'ABIN'), $1, null:INTEGER)], $f1=[CASE(=($2, 'ABIN'), $3, null:DECIMAL(19, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], SELLER_ID=[$1], LSTG_FORMAT_NAME0=[$2], SUM_CASE$0$0=[$3], $f4=[*(0, $4)], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_CASE$0$0=[SUM($3)], SUM_CONST$1=[COUNT()], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], SELLER_ID=[$7], LSTG_FORMAT_NAME0=[$3], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query31.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], COL1=[COUNT($0)], COL2=[SUM($1)], ctx=[])
    OlapProjectRel(SLR_SEGMENT_CD=[$2], $f1=[CASE(AND(>=($0, 2011-10-01), <=($0, 2012-10-31)), $3, 0:DECIMAL(19, 4))], ctx=[])
      OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
        OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], SLR_SEGMENT_CD=[$6], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query31.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[$SUM0($0)], AGG$1=[SUM($1)], ctx=[])
    OlapProjectRel(COL1=[$1], $f1=[CASE(AND(>=($0, 2011-10-01), <=($0, 2012-10-31)), $2, $3)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[$SUM0($1)], TOP_AGG$1=[SUM($2)], TOP_AGG$2=[SUM($3)], ctx=[])
        OlapProjectRel(CAL_DT=[$0], COL1=[$1], SUM_CASE$0$0=[$2], $f3=[CAST(*(0:DECIMAL(19, 4), $3)):DECIMAL(29, 4) NOT NULL], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], COL1=[COUNT($1)], SUM_CASE$0$0=[SUM($2)], SUM_CONST$2=[COUNT()], ctx=[])
            OlapProjectRel(CAL_DT=[$0], SLR_SEGMENT_CD=[$2], PRICE=[$3], ctx=[])
              OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
                OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], SLR_SEGMENT_CD=[$6], PRICE=[$8], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query32.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], COL=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[null:INTEGER], ctx=[])
      OlapFilterRel(condition=[=($0, 'FP-GTC')], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query32.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], TOP_AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[null:BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], SUM_CONST$0=[COUNT()], ctx=[])
        OlapProjectRel(ctx=[])
          OlapFilterRel(condition=[=($0, 'FP-GTC')], ctx=[])
            OlapProjectRel(LSTG_FORMAT_NAME=[$3], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query33.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], COL=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[null:DECIMAL(19, 4)], ctx=[])
      OlapFilterRel(condition=[=($0, 'FP-GTC')], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query33.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], TOP_AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[null:DECIMAL(29, 4)], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], SUM_CONST$0=[COUNT()], ctx=[])
        OlapProjectRel(ctx=[])
          OlapFilterRel(condition=[=($0, 'FP-GTC')], ctx=[])
            OlapProjectRel(LSTG_FORMAT_NAME=[$3], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query34.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], COL=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(<=(EXTRACT(FLAG(YEAR), $0), 2013), CASE(>($2, 0), $2, null:DECIMAL(19, 4)), null:DECIMAL(19, 4))], ctx=[])
      OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
        OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query34.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(<=(EXTRACT(FLAG(YEAR), $0), 2013), $1, null:DECIMAL(19, 4))], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(CAL_DT=[$0], $f1=[CASE(>($1, 0), $3, null:DECIMAL(19, 4))], SUM_CASE$0$1=[$2], ctx=[])
          OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], TOP_AGG$2=[SUM($4)], ctx=[])
            OlapProjectRel(CAL_DT=[$0], PRICE=[$1], $f2=[*(0, $2)], SUM_CASE$0$0=[$3], $f4=[*(0, $2)], ctx=[])
              OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_CONST$0=[COUNT()], SUM_CASE$0$0=[SUM($2)], ctx=[])
                OlapProjectRel(CAL_DT=[$0], PRICE=[$2], PRICE0=[$2], ctx=[])
                  OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
                    OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query35.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], COL1=[COUNT()], COL2=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($0, 2012-01-01), $2, 1:DECIMAL(19, 4))], ctx=[])
      OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
        OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query35.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[$SUM0($0)], AGG$1=[SUM($1)], ctx=[])
    OlapProjectRel(COL1=[$1], $f1=[CASE(=($0, 2012-01-01), $2, $3)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[$SUM0($1)], TOP_AGG$1=[SUM($2)], TOP_AGG$2=[SUM($3)], ctx=[])
        OlapProjectRel(CAL_DT=[$0], COL1=[$1], SUM_CASE$0$0=[$2], COL10=[CAST(CAST($1):DECIMAL(38, 4) NOT NULL):DECIMAL(29, 4) NOT NULL], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], COL1=[COUNT()], SUM_CASE$0$0=[SUM($1)], ctx=[])
            OlapProjectRel(CAL_DT=[$0], PRICE=[$2], ctx=[])
              OlapFilterRel(condition=[=($1, 'FP-GTC')], ctx=[])
                OlapProjectRel(CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query36.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AAA=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(>=($0, 2012-01-01), CAST($1):DECIMAL(30, 4), null:DECIMAL(30, 4))], ctx=[])
      OlapFilterRel(condition=[AND(>=($0, 2012-01-01), <($0, 2012-05-01))], ctx=[])
        OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query36.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(>=($0, 2012-01-01), CAST($1):DECIMAL(38, 4), null:DECIMAL(30, 4))], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(CAL_DT=[$0], SUM_CASE$0$0=[$1], $f2=[*(0, $2)], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
            OlapFilterRel(condition=[AND(>=($0, 2012-01-01), <($0, 2012-05-01))], ctx=[])
              OlapProjectRel(CAL_DT=[$2], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query37.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$0], COL92=[/($1, $2)], COL3=[ROUND(CAST(/($3, $4)):DECIMAL(34, 8), 4)], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], agg#0=[SUM($1)], agg#1=[COUNT()], agg#2=[SUM($2)], agg#3=[COUNT($2)], ctx=[])
      OlapProjectRel(COL1=[$10], $f1=[CASE(=($2, 'ABIN'), 0, 1)], $f2=[CASE(AND(=(EXTRACT(FLAG(YEAR), $10), 2012), =(EXTRACT(FLAG(MONTH), $10), 3), <=($10, 2012-03-13)), *($7, 2), OR(<>(EXTRACT(FLAG(YEAR), $10), 2012), <>(EXTRACT(FLAG(MONTH), $10), 3), >($10, 2012-03-13)), 1:DECIMAL(30, 4), null:DECIMAL(30, 4))], ctx=[])
        OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
          OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
            OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
              OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                  OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                    OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                          OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                          OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                        OlapProjectRel(CAL_DT=[$0], ctx=[])
                          OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                      OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                    OlapProjectRel(SITE_ID=[$0], ctx=[])
                      OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                  OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                    OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
            OlapProjectRel(COUNTRY=[$0], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
          OlapProjectRel(COUNTRY=[$0], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query37.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(COL1=[$0], COL92=[/($1, $2)], COL3=[ROUND(CAST(/($3, $4)):DECIMAL(34, 8), 4)], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], AGG$1=[$SUM0($2)], AGG$2=[SUM($3)], AGG$3=[$SUM0($4)], ctx=[])
      OlapProjectRel(CAL_DT0=[$0], $f1=[CASE(=($1, 'ABIN'), $5, $6)], $f3=[$3], $f4=[CASE(AND(=(EXTRACT(FLAG(YEAR), $2), 2012), =(EXTRACT(FLAG(MONTH), $2), 3), <=($2, 2012-03-13)), $7, OR(<>(EXTRACT(FLAG(YEAR), $2), 2012), <>(EXTRACT(FLAG(MONTH), $2), 3), >($2, 2012-03-13)), $8, null:DECIMAL(30, 4))], $f40=[$4], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[$SUM0($3)], AGG$1=[$SUM0($4)], AGG$2=[SUM($5)], AGG$3=[SUM($6)], AGG$4=[SUM($7)], AGG$5=[SUM($8)], AGG$6=[SUM($9)], ctx=[])
          OlapProjectRel(CAL_DT0=[$0], LSTG_FORMAT_NAME=[$1], CAL_DT00=[$2], $f3=[$3], $f4=[$4], SUM_CASE$0$0=[$5], SUM_CASE$0$1=[$6], $f7=[CAST(*($7, 2)):DECIMAL(38, 4)], SUM_CASE$1$1=[$8], SUM_CASE$1$2=[$9], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[$SUM0($3)], TOP_AGG$1=[$SUM0($4)], TOP_AGG$2=[SUM($5)], TOP_AGG$3=[SUM($6)], TOP_AGG$4=[SUM($7)], TOP_AGG$5=[SUM($8)], TOP_AGG$6=[SUM($9)], ctx=[])
              OlapProjectRel(CAL_DT0=[$0], LSTG_FORMAT_NAME=[$1], CAL_DT00=[$2], $f3=[$3], $f4=[$4], $f5=[*(0, $3)], $f30=[$3], SUM_OP$0=[$5], $f31=[CAST($3):DECIMAL(38, 4) NOT NULL], $f9=[*(0, $3)], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], agg#0=[COUNT()], agg#1=[COUNT($3)], SUM_OP$0=[SUM($4)], ctx=[])
                  OlapProjectRel(CAL_DT0=[$10], LSTG_FORMAT_NAME=[$2], CAL_DT00=[$10], $f3=[CASE(AND(=(EXTRACT(FLAG(YEAR), $10), 2012), =(EXTRACT(FLAG(MONTH), $10), 3), <=($10, 2012-03-13)), *($7, 2), OR(<>(EXTRACT(FLAG(YEAR), $10), 2012), <>(EXTRACT(FLAG(MONTH), $10), 3), >($10, 2012-03-13)), 1:DECIMAL(30, 4), null:DECIMAL(30, 4))], PRICE=[$7], ctx=[])
                    OlapJoinRel(condition=[=($18, $20)], joinType=[inner], ctx=[])
                      OlapJoinRel(condition=[=($16, $19)], joinType=[inner], ctx=[])
                        OlapJoinRel(condition=[=($9, $17)], joinType=[inner], ctx=[])
                          OlapJoinRel(condition=[=($6, $15)], joinType=[inner], ctx=[])
                            OlapJoinRel(condition=[=($5, $14)], joinType=[inner], ctx=[])
                              OlapJoinRel(condition=[=($4, $13)], joinType=[inner], ctx=[])
                                OlapJoinRel(condition=[AND(=($3, $11), =($4, $12))], joinType=[inner], ctx=[])
                                  OlapJoinRel(condition=[=($1, $10)], joinType=[inner], ctx=[])
                                    OlapJoinRel(condition=[=($0, $8)], joinType=[inner], ctx=[])
                                      OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], LSTG_FORMAT_NAME=[$3], LEAF_CATEG_ID=[$4], LSTG_SITE_ID=[$5], SLR_SEGMENT_CD=[$6], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                                        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                                      OlapProjectRel(ORDER_ID=[$0], BUYER_ID=[$1], ctx=[])
                                        OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                                    OlapProjectRel(CAL_DT=[$0], ctx=[])
                                      OlapTableScan(table=[[EDW, TEST_CAL_DT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
                                  OlapProjectRel(LEAF_CATEG_ID=[$0], SITE_ID=[$2], ctx=[])
                                    OlapTableScan(table=[[DEFAULT, TEST_CATEGORY_GROUPINGS]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]])
                                OlapProjectRel(SITE_ID=[$0], ctx=[])
                                  OlapTableScan(table=[[EDW, TEST_SITES]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
                              OlapProjectRel(SELLER_TYPE_CD=[$0], ctx=[])
                                OlapTableScan(table=[[EDW, TEST_SELLER_TYPE_DIM]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8]])
                            OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                              OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                          OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                            OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
                        OlapProjectRel(COUNTRY=[$0], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
                      OlapProjectRel(COUNTRY=[$0], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_COUNTRY]], ctx=[], fields=[[0, 1, 2, 3]])
]]>
        </Resource>
        <Resource name="query39.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$2], EXPR$1=[$3], EXPR$2=[$4], EXPR$3=[$5], EXPR$4=[$6], ACCOUNT_COUNTRY=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], EXPR$0=[COUNT()], EXPR$1=[SUM($2)], EXPR$2=[COUNT(DISTINCT $3)], EXPR$3=[COUNT(DISTINCT $4)], EXPR$4=[SUM($4)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$4], $f3=[CASE(=($0, 'ABIN'), $2, 2:DECIMAL(19, 4))], SELLER_ID=[$1], ACCOUNT_ID=[$3], ctx=[])
        OlapJoinRel(condition=[=($1, $3)], joinType=[left], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$3], SELLER_ID=[$7], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query39.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$2], EXPR$1=[$3], EXPR$2=[$4], EXPR$3=[$5], EXPR$4=[$6], ACCOUNT_COUNTRY=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$1], AGG$0=[$6], AGG$1=[$7], EXPR$2=[$2], EXPR$3=[$3], AGG$2=[$8], ctx=[])
      OlapJoinRel(condition=[AND(=($0, $4), =($1, $5))], joinType=[inner], ctx=[])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], EXPR$2=[COUNT(DISTINCT $3)], EXPR$3=[COUNT(DISTINCT $4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$4], $f2=[0:DECIMAL(19, 4)], SELLER_ID=[$1], ACCOUNT_ID=[$3], ctx=[])
            OlapJoinRel(condition=[=($1, $3)], joinType=[left], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
              OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[$SUM0($2)], AGG$1=[SUM($3)], AGG$2=[SUM($4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$1], EXPR$0=[$3], $f3=[CASE(=($2, 'ABIN'), $5, $6)], EXPR$4=[$4], ctx=[])
            OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[$SUM0($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[SUM($5)], TOP_AGG$3=[SUM($6)], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$1], LSTG_FORMAT_NAME0=[$2], EXPR$0=[$3], EXPR$4=[$4], SUM_CASE$0$0=[$5], $f6=[CAST(*(2:DECIMAL(19, 4), $3)):DECIMAL(29, 4) NOT NULL], ctx=[])
                OlapAggregateRel(group-set=[[0, 1, 2]], groups=[null], EXPR$0=[COUNT()], EXPR$4=[SUM($3)], SUM_CASE$0$0=[SUM($4)], ctx=[])
                  OlapProjectRel(LSTG_FORMAT_NAME=[$0], ACCOUNT_COUNTRY=[$4], LSTG_FORMAT_NAME0=[$0], ACCOUNT_ID=[$3], PRICE=[$2], ctx=[])
                    OlapJoinRel(condition=[=($1, $3)], joinType=[left], ctx=[])
                      OlapProjectRel(LSTG_FORMAT_NAME=[$3], SELLER_ID=[$7], PRICE=[$8], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                      OlapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
                        OlapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query40.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[ROUND($0, -1)], EXPR$1=[$1], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], agg#0=[PERCENTILE($0, $1)], EXPR$1=[SUM($2)], ctx=[])
      OlapProjectRel(PRICE=[$8], $f1=[0.5:DECIMAL(2, 1)], $f2=[CASE(>($0, 100), $9, 0)], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query40.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[ROUND($0, -1)], EXPR$1=[$1], ctx=[])
    OlapJoinRel(condition=[true], joinType=[inner], ctx=[])
      OlapAggregateRel(group-set=[[]], groups=[null], agg#0=[PERCENTILE($0, $1)], ctx=[])
        OlapProjectRel(PRICE=[$8], $f1=[0.5:DECIMAL(2, 1)], $f2=[0], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
      OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
        OlapProjectRel($f0=[CASE(>($0, 100), $1, $2)], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[SUM($2)], ctx=[])
            OlapProjectRel(TRANS_ID=[$0], SUM_CASE$0$0=[$1], $f2=[*(0, $2)], ctx=[])
              OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
                OlapProjectRel(TRANS_ID=[$0], ITEM_COUNT=[$9], ctx=[])
                  OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query41.planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$2], SUM_CAST_EXPR=[$3], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_EXPR=[SUM($2)], SUM_CAST_EXPR=[SUM($3)], ctx=[])
      OlapProjectRel(CAL_DT=[$2], ORDER_ID=[$1], $f2=[CASE(AND(=($1, 1050), =($2, 2012-10-29)), $8, null:DECIMAL(19, 4))], $f3=[CAST(CASE(AND(=($1, 1050), =($2, 2012-10-29)), $8, 0:DECIMAL(19, 4))):BIGINT], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query41.planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(SUM_EXPR=[$2], SUM_CAST_EXPR=[$3], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], AGG$1=[SUM($3)], ctx=[])
      OlapProjectRel(CAL_DT=[$0], ORDER_ID=[$1], $f2=[CASE(AND(=($2, 1050), =($3, 2012-10-29)), $5, null:DECIMAL(19, 4))], SUM_CAST_EXPR=[$4], ctx=[])
        OlapAggregateRel(group-set=[[0, 1, 2, 3]], groups=[null], TOP_AGG$0=[SUM($4)], TOP_AGG$1=[SUM($5)], TOP_AGG$2=[SUM($6)], ctx=[])
          OlapProjectRel(CAL_DT=[$0], ORDER_ID=[$1], ORDER_ID0=[$2], CAL_DT0=[$3], SUM_CAST_EXPR=[$4], SUM_CASE$0$0=[$5], $f6=[*(0, $6)], ctx=[])
            OlapProjectRel(CAL_DT=[$0], ORDER_ID=[$1], ORDER_ID0=[$2], CAL_DT0=[$3], SUM_CAST_EXPR=[CAST($4):BIGINT], SUM_CASE$0$0=[$5], SUM_CONST$2=[$6], ctx=[])
              OlapAggregateRel(group-set=[[0, 1, 2, 3]], groups=[null], AGG$0=[SUM($4)], AGG$1=[SUM($5)], AGG$2=[$SUM0($6)], ctx=[])
                OlapProjectRel(CAL_DT=[$0], ORDER_ID=[$1], ORDER_ID0=[$2], CAL_DT0=[$3], $f4=[CASE(AND(=($4, 1050), =($5, 2012-10-29)), $8, $9)], SUM_CASE$0$0=[$6], SUM_CONST$2=[$7], ctx=[])
                  OlapAggregateRel(group-set=[[0, 1, 2, 3, 4, 5]], groups=[null], TOP_AGG$0=[SUM($6)], TOP_AGG$1=[$SUM0($7)], TOP_AGG$2=[SUM($8)], TOP_AGG$3=[SUM($9)], ctx=[])
                    OlapProjectRel(CAL_DT=[$0], ORDER_ID=[$1], ORDER_ID0=[$2], CAL_DT0=[$3], ORDER_ID1=[$4], CAL_DT1=[$5], SUM_CASE$0$0=[$6], SUM_CONST$2=[$7], SUM_CASE$0$00=[$8], $f9=[CAST(*(0:DECIMAL(19, 4), $7)):DECIMAL(29, 4) NOT NULL], ctx=[])
                      OlapAggregateRel(group-set=[[0, 1, 2, 3, 4, 5]], groups=[null], SUM_CASE$0$0=[SUM($6)], SUM_CONST$2=[COUNT()], SUM_CASE$0$0=[SUM($7)], ctx=[])
                        OlapProjectRel(CAL_DT=[$2], ORDER_ID=[$1], ORDER_ID0=[$1], CAL_DT0=[$2], ORDER_ID1=[$1], CAL_DT1=[$2], PRICE=[$8], PRICE0=[$8], ctx=[])
                          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSimpleSQL">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($3, 'FP-non GTC'), $8, 2:DECIMAL(19, 4))], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($0, 'FP-non GTC'), $1, $2)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$0], SUM_CASE$0$0=[$1], $f2=[CAST(*(2:DECIMAL(19, 4), $2)):DECIMAL(29, 4) NOT NULL], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
            OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>

    <TestCase name="testWithAVG">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(PRICE1=[CAST(/($0, $1)):DECIMAL(23, 8)], TOTAL_PRICE=[$2], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], agg#0=[SUM($0)], agg#1=[COUNT($0)], TOTAL_PRICE=[SUM($1)], ctx=[])
      OlapProjectRel(PRICE=[$8], $f1=[CASE(=($3, 'FP-non GTC'), $8, 0:DECIMAL(19, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(PRICE1=[CAST(/($0, $1)):DECIMAL(23, 8)], TOTAL_PRICE=[$2], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], AGG$1=[$SUM0($1)], AGG$2=[SUM($2)], ctx=[])
      OlapProjectRel($f1=[$1], $f2=[$2], $f3=[CASE(=($0, 'FP-non GTC'), $3, $4)], ctx=[])
        OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[$SUM0($2)], TOP_AGG$2=[SUM($3)], TOP_AGG$3=[SUM($4)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$0], $f1=[$1], $f2=[$2], SUM_CASE$0$0=[$3], $f4=[CAST(*(0:DECIMAL(19, 4), $4)):DECIMAL(29, 4) NOT NULL], ctx=[])
            OlapAggregateRel(group-set=[[0]], groups=[null], agg#0=[SUM($1)], agg#1=[COUNT($2)], SUM_CASE$0$0=[SUM($3)], SUM_CONST$3=[COUNT()], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], PRICE0=[$8], PRICE1=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>

    <TestCase name="testSumCastTransposeRule">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($3, 'FP-non GTC'), CAST($8):DECIMAL(23, 4), CAST($4):DECIMAL(23, 4))], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($0, 'FP-non GTC'), CAST($1):DECIMAL(33, 4), CAST($2):DECIMAL(33, 4))], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CASE$0$1=[SUM($2)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], LEAF_CATEG_ID=[$4], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumCastTransposeRuleWithGroupby">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], EXPR$0=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$3], $f1=[CASE(=($3, 'FP-non GTC'), CAST($8):DECIMAL(23, 4), CAST($4):DECIMAL(23, 4))], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$0], $f1=[CASE(=($1, 'FP-non GTC'), CAST($2):DECIMAL(33, 4), CAST($3):DECIMAL(33, 4))], ctx=[])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_CASE$0$0=[SUM($2)], SUM_CASE$0$1=[SUM($3)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$3], LSTG_FORMAT_NAME0=[$3], PRICE=[$8], LEAF_CATEG_ID=[$4], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumCastTransposeRule2">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CAST($8):BIGINT], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[CAST($0):BIGINT], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
      OlapProjectRel(PRICE=[$8], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumCastTransposeRule3">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapAggregateRel(group-set=[[0]], groups=[null], EXPR$0=[SUM($1)], ctx=[])
      OlapProjectRel(LSTG_FORMAT_NAME=[$3], $f1=[CAST($8):BIGINT], ctx=[])
        OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[$1], LSTG_FORMAT_NAME=[$0], ctx=[])
    OlapProjectRel(LSTG_FORMAT_NAME=[$0], EXPR$0=[CAST($1):BIGINT], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], EXPR$0=[SUM($1)], ctx=[])
        OlapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumCastTransposeRule4">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CAST($1):BIGINT], ctx=[])
      OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
        OlapProjectRel(ORDER_ID=[$1], PRICE=[$8], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        OlapProjectRel(ORDER_ID=[$0], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[CAST($0):BIGINT], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
      OlapProjectRel(PRICE=[$1], ctx=[])
        OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          OlapProjectRel(ORDER_ID=[$1], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          OlapProjectRel(ORDER_ID=[$0], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumCastTransposeRuleMultiplyConstant">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[*(CAST($8):BIGINT, 10)], ctx=[])
      OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapProjectRel(EXPR$0=[CAST($0):BIGINT], ctx=[])
    OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
      OlapProjectRel($f0=[*($0, 10)], ctx=[])
        OlapAggregateRel(group-set=[[]], groups=[null], SUM_OP$0=[SUM($0)], ctx=[])
          OlapProjectRel(PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>

    <TestCase name="testAggPushdown">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[0]], groups=[null], TEMP_Calculation_54915774428294=[SUM($1)], TEMP_Calculation_97108873613918=[COUNT($0)], TEMP_Calculation_97108873613918=[COUNT(DISTINCT $0)], TEMP_Calculation_97108873613911=[COUNT(DISTINCT $2)], ctx=[])
    OlapProjectRel(CAL_DT=[$1], SELLER_ID=[$2], $f2=[CASE(>($5, 0), $3, null:VARCHAR(4096))], ctx=[])
      OlapJoinRel(condition=[=($0, $4)], joinType=[inner], ctx=[])
        OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], SELLER_ID=[$7], ctx=[])
          OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        OlapAggregateRel(group-set=[[0, 1]], groups=[null], X_measure__0=[SUM($2)], ctx=[])
          OlapProjectRel(LSTG_FORMAT_NAME=[$3], ORDER_ID=[$1], PRICE=[$8], ctx=[])
            OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[0]], groups=[null], TEMP_Calculation_54915774428294=[SUM($2)], TEMP_Calculation_97108873613918=[$SUM0($3)], TEMP_Calculation_97108873613918=[COUNT(DISTINCT $0)], TEMP_Calculation_97108873613911=[COUNT(DISTINCT $1)], ctx=[])
    OlapAggregateRel(group-set=[[0, 1]], groups=[null], TEMP_Calculation_54915774428294=[SUM($2)], TEMP_Calculation_97108873613918=[$SUM0($3)], ctx=[])
      OlapProjectRel(CAL_DT=[$0], $f2=[CASE(>($2, 0), $1, null:VARCHAR(4096))], $3=[$3], $4=[$4], ctx=[])
        OlapAggregateRel(group-set=[[1, 4, 6]], groups=[null], TEMP_Calculation_54915774428294=[SUM($2)], TEMP_Calculation_97108873613918=[$SUM0($3)], ctx=[])
          OlapJoinRel(condition=[=($0, $5)], joinType=[inner], ctx=[])
            OlapAggregateRel(group-set=[[0, 1]], groups=[null], TEMP_Calculation_54915774428294=[SUM($2)], TEMP_Calculation_97108873613918=[COUNT($1)], ctx=[])
              OlapProjectRel(ORDER_ID=[$1], CAL_DT=[$2], SELLER_ID=[$7], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
            OlapAggregateRel(group-set=[[0, 1]], groups=[null], X_measure__0=[SUM($2)], ctx=[])
              OlapProjectRel(LSTG_FORMAT_NAME=[$3], ORDER_ID=[$1], PRICE=[$8], ctx=[])
                OlapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>

    <TestCase name="testAggPushdownWithCrossJoin1">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapLimitRel(ctx=[], fetch=[500])
    OlapProjectRel(sum_LO_QUANTITY_SUM______88=[$1], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], sum_LO_QUANTITY_SUM______88=[SUM($1)], ctx=[])
        OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], $f1=[CASE(=($0, $2), $1, null:BIGINT)], ctx=[])
          OlapJoinRel(condition=[true], joinType=[inner], ctx=[])
            OlapProjectRel(LO_ORDERDATE=[$5], LO_QUANTITY=[$8], ctx=[])
              OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
            OlapProjectRel(X_measure__0=[$1], ctx=[])
              OlapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[MAX($1)], ctx=[])
                OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], LO_ORDERDATE=[$5], ctx=[])
                  OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapLimitRel(ctx=[], fetch=[500])
    OlapProjectRel(sum_LO_QUANTITY_SUM______88=[$1], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
        OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], $f1=[CASE(=($0, $1), $2, null:BIGINT)], ctx=[])
          OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], ctx=[])
            OlapProjectRel(LO_ORDERDATE=[$0], X_measure__0=[$1], SUM_CASE$0$0=[$2], $f3=[*(0, $3)], ctx=[])
              OlapProjectRel(LO_ORDERDATE=[$0], X_measure__0=[$3], SUM_CASE$0$0=[$1], SUM_CONST$1=[$2], ctx=[])
                OlapJoinRel(condition=[true], joinType=[inner], ctx=[])
                  OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
                    OlapProjectRel(LO_ORDERDATE=[$5], LO_QUANTITY=[$8], ctx=[])
                      OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
                  OlapProjectRel(X_measure__0=[$1], ctx=[])
                    OlapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[MAX($1)], ctx=[])
                      OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], LO_ORDERDATE=[$5], ctx=[])
                        OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSumExpressionSkipProjectJoinTransposeRule">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($0, 20230501), $1, null:BIGINT)], ctx=[])
      OlapFilterRel(condition=[=($0, $2)], ctx=[])
        OlapJoinRel(condition=[true], joinType=[left], ctx=[])
          OlapProjectRel(LO_COMMITDATE=[$15], LO_DISCOUNT=[$11], ctx=[])
            OlapTableScan(table=[[SSB, P_LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]])
          OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[MAX($0)], ctx=[])
            OlapProjectRel(LO_COMMITDATE=[$15], ctx=[])
              OlapTableScan(table=[[SSB, P_LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapAggregateRel(group-set=[[]], groups=[null], AGG$0=[SUM($0)], ctx=[])
    OlapProjectRel($f0=[CASE(=($0, 20230501), $1, null:BIGINT)], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], TOP_AGG$0=[SUM($1)], TOP_AGG$1=[SUM($2)], ctx=[])
        OlapProjectRel(LO_COMMITDATE=[$0], SUM_CASE$0$0=[$1], $f2=[*(0, $2)], ctx=[])
          OlapAggregateRel(group-set=[[0]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
            OlapProjectRel(LO_COMMITDATE=[$0], LO_DISCOUNT=[$1], ctx=[])
              OlapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
                OlapProjectRel(LO_COMMITDATE=[$15], LO_DISCOUNT=[$11], ctx=[])
                  OlapTableScan(table=[[SSB, P_LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]])
                OlapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[MAX($0)], ctx=[])
                  OlapProjectRel(LO_COMMITDATE=[$15], ctx=[])
                    OlapTableScan(table=[[SSB, P_LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]])
]]>
        </Resource>
    </TestCase>

    <TestCase name="testAggPushdownWithCrossJoin2">
        <Resource name="planBefore">
            <![CDATA[
OlapToEnumerableConverter
  OlapLimitRel(ctx=[], fetch=[500])
    OlapProjectRel(sum_LO_QUANTITY_SUM______88=[$1], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], sum_LO_QUANTITY_SUM______88=[SUM($1)], ctx=[])
        OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], $f1=[CASE(=($0, $2), $1, null:BIGINT)], ctx=[])
          OlapFilterRel(condition=[>($1, 1)], ctx=[])
            OlapJoinRel(condition=[true], joinType=[inner], ctx=[])
              OlapProjectRel(LO_ORDERDATE=[$5], LO_QUANTITY=[$8], ctx=[])
                OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
              OlapProjectRel(X_measure__0=[$1], ctx=[])
                OlapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[MAX($1)], ctx=[])
                  OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], LO_ORDERDATE=[$5], ctx=[])
                    OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
OlapToEnumerableConverter
  OlapLimitRel(ctx=[], fetch=[500])
    OlapProjectRel(sum_LO_QUANTITY_SUM______88=[$1], ctx=[])
      OlapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], ctx=[])
        OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], $f1=[CASE(=($0, $1), $2, null:BIGINT)], ctx=[])
          OlapAggregateRel(group-set=[[0, 1]], groups=[null], TOP_AGG$0=[SUM($2)], TOP_AGG$1=[SUM($3)], ctx=[])
            OlapProjectRel(LO_ORDERDATE=[$0], X_measure__0=[$1], SUM_CASE$0$0=[$2], $f3=[*(0, $3)], ctx=[])
              OlapAggregateRel(group-set=[[0, 2]], groups=[null], SUM_CASE$0$0=[SUM($3)], SUM_CONST$1=[$SUM0($4)], ctx=[])
                OlapFilterRel(condition=[>($1, 1)], ctx=[])
                  OlapProjectRel(LO_ORDERDATE=[$0], LO_QUANTITY=[$1], X_measure__0=[$4], SUM_CASE$0$0=[$2], SUM_CONST$1=[$3], ctx=[])
                    OlapJoinRel(condition=[true], joinType=[inner], ctx=[])
                      OlapAggregateRel(group-set=[[0, 1]], groups=[null], SUM_CASE$0$0=[SUM($1)], SUM_CONST$1=[COUNT()], ctx=[])
                        OlapProjectRel(LO_ORDERDATE=[$5], LO_QUANTITY=[$8], ctx=[])
                          OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
                      OlapProjectRel(X_measure__0=[$1], ctx=[])
                        OlapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[MAX($1)], ctx=[])
                          OlapProjectRel($f0=[1.1000000000000001:DECIMAL(17, 16)], LO_ORDERDATE=[$5], ctx=[])
                            OlapTableScan(table=[[SSB, LINEORDER]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]])
]]>
        </Resource>
    </TestCase>
</Root>
